Username Enumeration
---------------------
When trying to find authentication vulnerabilities is creating a list of valid usernames
Website error messages are great resources for collecting info to build valid usernames List. Find "Form" to create a new user account
Try signing up as admin, fill in the other form fields with fake information, you'll see we get the error An account with this username already exists. We can
use the existence of this error message to produce a list of valid usernames already signed up on the system using FFUF

 ffuf -w /usr/share/wordlists/SecLists/Usernames/Names/names.txt -X POST -d "username=FUZZ&email=x&password=x&cpassword=x" -H "Content-Type: application/x-www-form-urlencoded" -u http://VictimIP/customers/signup -mr "username already exists"

          -w arg point to list of usernames
          -X arg specifies the request method (default GET) 
          -d arg specifies the data that we are going to send "fields above: username, email, password and cpassword
              Set value of the username to FUZZ. In the ffuf tool, the FUZZ keyword signifies where the contents from our wordlist will be inserted in the request
          -H arg for additional headers to the request. "Content-Type to the webserver knows we are sending form data"
          -u arg specifies the URL we are making the request to
          -mr arg is the text on the page we are looking for to validate we've found a valid username.
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Brute Force
-----------
Using the valid_usernames.txt file we generated in the previous task, we can now use this to attempt a brute force attack on the login page (http://MACHINE_IP/customers/login).



A brute force attack is an automated process that tries a list of commonly used passwords against either a single username or, like in our case, a list of usernames.



When running this command, make sure the terminal is in the same directory as the valid_usernames.txt file.

"user@tryhackme$ ffuf -w valid_usernames.txt:W1,/usr/share/wordlists/SecLists/Passwords/Common-Credentials/10-million-password-list-top-100.txt:W2 -X POST -d "username=W1&password=W2" -H "Content-Type: application/x-www-form-urlencoded" -u http://MACHINE_IP/customers/login -fc 200"

This ffuf command is a little different to the previous one in Task 2. Previously we used the FUZZ keyword to select where in the request the data from the wordlists would be inserted, but because we're using multiple wordlists, we have to specify our own FUZZ keyword. In this instance, we've chosen W1 for our list of valid usernames and W2 for the list of passwords we will try. The multiple wordlists are again specified with the -w argument but separated with a comma.  For a positive match, we're using the -fc argument to check for an HTTP status code other than 200.

Running the above command will find a single working username and password combination that answers the question below.
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Logic Flaw
 -----------
 













