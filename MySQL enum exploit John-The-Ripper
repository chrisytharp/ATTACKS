-----------------------------------------------------------------------------------------------------------------------------------------------------------------
ENUMERATE 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
When you would begin attacking MySQL

MySQL is likely not going to be the first point of call when getting initial information about the server. You can, as we have in previous tasks, attempt to 
brute-force default account passwords if you really don't have any other information; however, in most CTF scenarios, this is unlikely to be the avenue you're 
meant to pursue.

The Scenario

Typically, you will have gained some initial credentials from enumerating other services that you can then use to enumerate and exploit the MySQL service. 
As this room focuses on exploiting and enumerating the network service, for the sake of the scenario, we're going to assume that you found the credentials: 
"root:password" while enumerating subdomains of a web server. After trying the login against SSH unsuccessfully, you decide to try it against MySQL.

Requirements

"sudo apt install default-mysql-client" Don't worry- this won't install the server package on your system- just the client.

METASPLOIT

Alternatives

This can also be done either manually or with a set of non-Metasploit tools such as nmap's mysql-enum script:
        https://nmap.org/nsedoc/scripts/mysql-enum.html 
        https://www.exploit-db.com/exploits/23081. 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
ENUMERATION cont..        SCENERIO: We have found "root:password" 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
1- Port scan to find what port is MySQL using
2- Double check we can manually connect to the MySQL server w/ "root:password" 
                        "mysql -h [IP] -u [username] -p" 
3- Launch Metasploit "msfconsole"
4- "search mysql_sql" module
5- "USE" mysql_sql && set "OPTIONS"
6- Change the "sql" option to "show databases". how many databases are returned?
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
EXPLOIT        SCENERIO: We have found "root:password" 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
What do we know?

Let's take a sanity check before moving on to try and exploit the database fully, and gain more sensitive information than just database names. We know:
        1. MySQL server credentials
        2. The version of MySQL running
        3. The number of Databases, and their names.

Key Terminology
        In order to understand the exploits we're going to use next- we need to understand a few key terms.
Schema:
        In MySQL, a schema is synonymous with a database. You can substitute the word "SCHEMA" with DATABASE in MySQL SQL syntax, 
        -example using CREATE SCHEMA instead of CREATE DATABASE. It's important to understand this relationship because some other 
        database products draw a distinction. For example, in Oracle Database products, a schema represents only a part of a database: 
        the tables and other objects owned by a single user.

Hashes: 
        Hashes are the product of a cryptographic algorithm to turn a variable length input into a fixed length output.

        In MySQL hashes can be used in different ways, for instance: to index data into a hash table. Each "hash" has an "unique ID" that 
        serves as a "pointer" to the "original data". This creates an index that is significantly smaller than the original data, allowing 
        the values to be searched and accessed more efficiently

        The data we're going to be extracting are "password hashes" which are simply a way of storing passwords not in plaintext format.

1- "search" for and "use" the "mysql_schemadump" module.
2- "Set" the relevant options
3- Run the "exploit"
4- What's the names of the tables dumped?
5- Now tables are dumped & column names of the whole database. 
6- "Search" for and "use" the "mysql_hashdump" module. 
7- "Set" the relevant options
8- "run" the exploit.
9- Copy the hash string in full, like: bob:*HASH to a text file on your local machine called "hash.txt".
10- Crack the hash w/ John the Ripper 
        "john hash.txt" 



